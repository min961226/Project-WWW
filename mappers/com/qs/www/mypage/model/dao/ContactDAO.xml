<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ContactDAO">
	<resultMap type="com.qs.www.mypage.model.dto.ContactDTO" id="contactResultMap">
		<id property="code" column="DEPT_CODE"/>
		<result property="name" column="DEPT_NAME"/>
		<result property="number" column="DEPT_CALL_NUMBER"/>
		
	</resultMap>
	
	<select id="selectAllContactList" resultMap="contactResultMap">
        SELECT /* com.qs.www.mypage.model.dao.ContactDAO#selectAllContactList() */
               A.DEPT_CODE
             , A.DEPT_NAME
             , A.DEPT_CALL_NUMBER
         	FROM TBL_DEPARTMENT A
	</select>
	
	<select id="selectBoardList" resultMap="contactResultMap">
         SELECT 
                C.RNUM
        	  , C.BOARD_NO
              , C.BOARD_TITLE
         	  , C.MEMBER_NO
              , C.BOARD_TYPE
              , C.BOARD_COUNT
              , C.BOARD_BODY
              , C.DELETE_YN
              , C.CREATED_DATE
              , C.MODIFIED_DATE
              , C.NAME
          FROM (SELECT ROWNUM RNUM
          			 , B.BOARD_NO
                     , B.BOARD_TITLE
           			 , B.MEMBER_NO
		             , B.BOARD_TYPE
		             , B.BOARD_COUNT
		             , B.BOARD_BODY
		             , B.DELETE_YN
		             , B.CREATED_DATE
		             , B.MODIFIED_DATE
		             , B.NAME
                  FROM (SELECT A.BOARD_NO
             				 , A.BOARD_TITLE
             				 , A.MEMBER_NO
				             , A.BOARD_TYPE
				             , A.BOARD_COUNT
				             , A.BOARD_BODY
				             , A.DELETE_YN
				             , A.CREATED_DATE
				             , A.MODIFIED_DATE
				             , D.NAME
                          FROM TBL_BOARD A
	      				  LEFT JOIN TBL_MEMBER D ON(A.MEMBER_NO = D.MEMBER_NO)
    					<where>
							<if test="searchCondition == 'name'">
	           				   D.NAME LIKE '%' || #{ searchValue } || '%'	
							</if>
							<if test="searchCondition == 'title'">
	           				   A.BOARD_TITLE LIKE '%' || #{ searchValue } || '%' 	
							</if>
							<if test="searchCondition == 'body'">
	           				   A.BOARD_BODY LIKE '%' || #{ searchValue } || '%' 	
							</if>
	       				   AND A.DELETE_YN = 'N'
	       				   AND A.BOARD_TYPE = '자유'
    					</where>
                         ORDER BY A.BOARD_NO DESC
                        ) B
                  <![CDATA[
                  WHERE ROWNUM <= #{ endRow }
                  ]]>
               ) C
         WHERE C.RNUM >= #{ startRow }     
	</select>
	

	
		<select id="selectAllCount" resultType="_int" parameterType="hashmap">
        SELECT /* com.qs.www.mypage.model.dao.ContactDAO#selectAllCount() */
               COUNT(*)
          FROM TBL_BOARD A
          LEFT JOIN TBL_MEMBER D ON(A.MEMBER_NO = D.MEMBER_NO)
    	<where>
			<if test="searchCondition == 'name'">
	           D.NAME LIKE '%' || #{ searchValue } || '%'	
			</if>
			<if test="searchCondition == 'title'">
	           A.BOARD_TITLE LIKE '%' || #{ searchValue } || '%' 	
			</if>
			<if test="searchCondition == 'body'">
	           A.BOARD_BODY LIKE '%' || #{ searchValue } || '%' 	
			</if>
			AND A.DELETE_YN = 'N'
            AND A.BOARD_TYPE = '자유'
            
    	</where>
	</select>
	

	
</mapper>