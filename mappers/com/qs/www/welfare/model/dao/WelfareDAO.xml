<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="WelfareDAO">


	<resultMap type="com.qs.www.welfare.model.dto.WelfareListDTO" id="welfareResultMap">
		<result property="reportNo" column="REPORT_NO" />
		<result property="memberNo" column="MEMBER_NO" />
		<result property="reportNote" column="REPORT_NOTE" />
		<result property="documentNo" column="DOCUMENT_NO" />
		<result property="selfDevName" column="DEVELOPMENT_TYPE_NAME" />
		<result property="welfareTitle" column="DOCUMENT_NAME" />
		<result property="selfDevDate" column="ITEM_NAME" />
		<result property="lineName" column="LINE_NAME" />
		<result property="priority" column="PRIORITHY" />

	</resultMap>
	
	<resultMap type="com.qs.www.schedule.model.dto.ReportDTO" id="appliedWelfareResultMap">
		<result property="reportNo" column="REPORT_NO" />
		<result property="reportDate" column="REPORT_DATE" />
		<result property="memberNo" column="MEMBER_NO" />
		<result property="documentNo" column="DOCUMENT_NO" />
		<result property="reportNote" column="REPORT_NOTE" />
		<result property="reportStatus" column="REPORT_STATUS" />
		<result property="lineName" column="LINE_NAME" />
		<result property="reportTitle" column="REPORT_TITLE" />
	</resultMap>
	
	<resultMap type="com.qs.www.welfare.model.dto.FamilyEventDTO" id="familyEventResultMap">
		<result property="eventNo" column="EVENT_NO" />
		<result property="eventType" column="EVENT_TYPE" />
		<result property="supportFund" column="SUPPORT_FUND" />
		<result property="relation" column="EVENT_RELATED_PERSON" />
		<result property="wreathStatus" column="WREATH_STATUS" />

	</resultMap>
	
	<resultMap type="com.qs.www.welfare.model.dto.MemberOverTimeLogDTO" id="memberOverTimeLogResultMap">
		<result property="overTimelogNo" column="MEMBER_OVERTIME_LOG_NO" />
		<result property="reportNo" column="OVERTIME_REPORT_NO" />
		<result property="memberNo" column="MEMBER_NO" />
		<result property="overTimeStartDay" column="OVERTIME_START_DAY" />
		<result property="overTimeStartTime" column="OVERTIME_START_TIME" />
		<result property="overTimeEndDay" column="OVERTIME_END_DAY" />
		<result property="overTimeEndTime" column="OVERTIME_END_TIME" />
		<result property="overTimeHour" column="OVERTIME_DURING" />
		<result property="TransBill" column="TRANS_BILL" />

	</resultMap>
	
	<resultMap type="com.qs.www.welfare.model.dto.DomitoryListDTO" id="domitoryListResultMap">
		<result property="domitoryManageNo" column="DOMITORY_MANAGE_NO" />
		<result property="domitoryBlockNo" column="BLOCK_NO" />
		<result property="roomNo" column="ROOM_NO" />
		<result property="currCapacity" column="CURR_CAPACITY" />
		<result property="maxCapacity" column="MAX_CAPACITY" />
	</resultMap>

<select id="selectWelfareList" resultType="java.lang.String">
	SELECT /* com.qs.www.welfare.model.dao.WelfareDAO#checkWelfareList()*/
		   A.DOCUMENT_NAME
	  FROM TBL_DOCUMENT_FORM A
	 WHERE CATEGORY_CODE = 'C2'
       AND DOCUMENT_NAME LIKE '%신청서'
	   AND USE_YN = 'Y'
</select>


<select id="checkSelfDevList" resultType="java.lang.String">
	SELECT /* com.qs.www.welfare.model.dao.WelfareDAO#checkSelfDevList()*/
		   A. DEVELOPMENT_TYPE_NAME
	  FROM TBL_SELF_DEVELOPMENT A
</select>

<select id="selectApproverLine" resultType="java.lang.String">
	SELECT /* com.qs.www.welfare.model.dao.WelfareDAO#selectApproverLine()*/
		   A.APPROVER_NAME
	  FROM TBL_APPROVER A
	 WHERE MEMBER_NO = #{ memberNo }
</select>

<insert id="insertWelfareReport" parameterType="com.qs.www.welfare.model.dto.WelfareListDTO">

	INSERT /* com.qs.www.welfare.model.dao.WelfareDAO#insertSelfDevelopment() */
	  INTO TBL_REPORT A
	(
	  A.REPORT_NO
	, A.REPORT_DATE
	, A.MEMBER_NO
	, A.DOCUMENT_NO
	, A.REPORT_NOTE
	, A.REPORT_STATUS
	, A.LINE_NAME
	, A.REPORT_TITLE
	)
	VALUES
	(
	  SEQ_REPORT_NO.NEXTVAL
	, SYSDATE
	, #{ memberNo }
	, #{ documentNo }
	, #{ reportNote }
	, DEFAULT
	, #{ lineName }
	, #{ welfareTitle }
	)
	</insert>
	
	<select id="selectReportNum" resultType="_int">
		SELECT /* com.qs.www.welfare.model.dao.WelfareDAO#selectReportNum() */
		       LAST_NUMBER
		  FROM USER_SEQUENCES
		 WHERE SEQUENCE_NAME = 'SEQ_REPORT_NO'
	</select>
	
	<select id="selectDevNo" resultType="_int">
		SELECT /* com.qs.www.welfare.model.dao.WelfareDAO#selectDevNo() */
		       DEVELOPMENT_NO
		  FROM TBL_SELF_DEVELOPMENT
		 WHERE DEVELOPMENT_TYPE_NAME = #{ lineName }
	</select>
	
	<select id="selectLimitCost" resultType="_int">
		SELECT /* com.qs.www.welfare.model.dao.WelfareDAO#selectLimitCost() */
			   MONTH_LIMIT_COST
		  FROM TBL_SELF_DEVELOPMENT
		 WHERE DEVELOPMENT_NO = #{ developmentNo }
	</select>
	
	<select id="selectEventNo" parameterType="com.qs.www.welfare.model.dto.FamilyEventDTO" resultType="_int">
		SELECT /* com.qs.www.welfare.model.dao.WelfareDAO#selectEventNo() */
			   EVENT_NO
		  FROM TBL_FAMILY_EVENT_TYPE
		 WHERE EVENT_TYPE = #{ eventType }
		   AND EVENT_RELATED_PERSON = #{ relation }
		   AND WREATH_STATUS = #{ wreathStatus }
	</select>
	
	<select id="selectSupportFund" resultType="_int">
		SELECT /* com.qs.www.welfare.model.dao.WelfareDAO#selectEventNo() */
			   SUPPORT_FUND
		  FROM TBL_FAMILY_EVENT_TYPE
		 WHERE EVENT_NO = #{ eventNo }
	</select>
	
	<select id="checkNightTrans" resultMap="memberOverTimeLogResultMap">
		SELECT /* com.qs.www.welfare.model.dao.WelfareDAO#selectEventNo() */
			   A.*
		  FROM TBL_MEMBER_OVERTIME_LOG A
		 WHERE MEMBER_NO = #{ memberNo }
		   AND TRANS_BILL = 'N'
	</select>
	
	<select id="selectDomitory" resultMap="domitoryListResultMap">
		SELECT /* com.qs.www.welfare.model.dao.WelfareDAO#selectDomitory() */
			   A.*
		  FROM TBL_DOMITORY A
	</select>
	
	<select id="selectAppliedWelfareList" resultMap="appliedWelfareResultMap">
	SELECT /* com.qs.www.welfare.model.dao.welfareDAO#selectAppliedWelfare() */
	       A.REPORT_NO
	     , A.REPORT_DATE
	     , A.MEMBER_NO
	     , A.DOCUMENT_NO
	     , A.REPORT_NOTE
	     , A.REPORT_STATUS
	     , A.LINE_NAME
	     , A.REPORT_TITLE
	  FROM TBL_REPORT A
	 WHERE A.MEMBER_NO = #{ no }
	   AND A.DOCUMENT_NO IN (7,8,9,10,12)
	   AND REPORT_STATUS != '회수'
	 ORDER BY A.REPORT_NO DESC
	</select>
	
	
</mapper>